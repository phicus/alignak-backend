[
    {
        '$match': {
            'name': {
                '$ne': '_dummy'
            },
            '_is_template': False
        }
    },
    {
        '$match': {
            '$and': [
                {
                    'ls_state_id': {
                        '$ne': 0
                    }
                },
                {
                    'ls_state': {
                        '$ne': 'PENDING'
                    }
                },
                {
                    'ls_acknowledged': False
                },
                {
                    'ls_downtimed': False
                },
                {
                    'ls_state_type': {
                        '$ne': 'SOFT'
                    }
                },
                {
                    'business_impact': {
                        '$gte': 2
                    }
                },
                {
                    'hostgroups': re.compile(
                    'gpon',
                    re.IGNORECASE)
                },
                {
                    'ls_perfs.rta': {
                        '$lt': 50.0
                    }
                }
            ]
        }
    },
    {
        '$sort': {
            'business_impact': -1,
            'ls_state_id': -1,
            '_id': 1
        }
    },
    {
        '$skip': 0
    },
    {
        '$limit': 10
    },
    {
        '$project': {
            'name': 1,
            'ls_acknowledged': 1,
            'active_checks_enabled': 1,
            'downtimed': 1,
            'event_handler_enabled': 1,
            'business_impact': 1,
            'ls_state_id': 1,
            'ls_state': 1,
            'ls_last_check': 1,
            'ls_next_check': 1,
            'ls_output': 1
        }
    }
]
